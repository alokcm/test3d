{"version":3,"sources":["file:///Users/Alok/Cocos%203D/HelloWorld3D/assets/scripts/PlayerController.ts"],"names":["_decorator","Component","Vec3","systemEvent","SystemEvent","Animation","ccclass","property","PlayerController","type","start","onMouseUp","event","getButton","jumpByStep","step","_isMoving","BodyAnim","play","_startJump","_jumpStep","_currJumpTime","_currJumpSpeed","_jumpTime","node","getPosition","_currPos","add","_targetPos","_currMoveIndex","onOnceJumpEnd","emit","update","deltaTime","setPosition","_deltaPos","x","setInputActive","active","on","EventType","MOUSE_UP","off","reset"],"mappings":"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","sourcesContent":["\r\nimport { _decorator, Component, Node, Vec3, systemEvent, SystemEvent, EventMouse, Animation } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\n/**\r\n * Predefined variables\r\n * Name = PlayerController\r\n * DateTime = Thu Dec 09 2021 11:52:55 GMT+0530 (India Standard Time)\r\n * Author = alokraj0024\r\n * FileBasename = PlayerController.ts\r\n * FileBasenameNoExtension = PlayerController\r\n * URL = db://assets/scripts/PlayerController.ts\r\n * ManualUrl = https://docs.cocos.com/creator/3.3/manual/en/\r\n *\r\n */\r\n \r\n@ccclass('PlayerController')\r\nexport class PlayerController extends Component {\r\n    // [1]\r\n    // dummy = '';\r\n\r\n    // [2]\r\n    // @property\r\n    // serializableDummy = 0;\r\n\r\n    @property({type : Animation})\r\n    public BodyAnim : Animation|null = null;\r\n\r\n\r\n    private _startJump : boolean = false;\r\n    private _jumpStep : number = 0;\r\n    private _currJumpTime : number = 0;\r\n    private _jumpTime : number = 0.1;\r\n    private _currJumpSpeed : number = 0;\r\n    private _currPos : Vec3 = new Vec3();\r\n    private _deltaPos : Vec3 = new Vec3(0,0,0);\r\n    private _targetPos : Vec3 = new Vec3();\r\n    private _isMoving : boolean = false;\r\n    private _currMoveIndex : number = 0;\r\n\r\n    start () {\r\n        // [3]\r\n        //systemEvent.on(SystemEvent.EventType.MOUSE_UP,this.onMouseUp,this);\r\n    }\r\n\r\n    onMouseUp(event : EventMouse)\r\n    {\r\n        switch(event.getButton())\r\n        {\r\n            case 0 :\r\n                this.jumpByStep(1);\r\n                break;\r\n            case 2 :\r\n                this.jumpByStep(2);\r\n        }\r\n    }\r\n\r\n    jumpByStep(step : number)\r\n    {\r\n        if(this._isMoving)\r\n            return;\r\n        \r\n\r\n        if (this.BodyAnim) {\r\n            if (step === 1) {\r\n                this.BodyAnim.play('oneStep');\r\n            }\r\n            else if (step === 2) {\r\n                this.BodyAnim.play('twoStep');\r\n            }\r\n        }    \r\n\r\n        this._startJump = true;\r\n        this._jumpStep = step;\r\n        this._currJumpTime = 0;\r\n        this._currJumpSpeed = this._jumpStep / this._jumpTime;\r\n        this.node.getPosition(this._currPos);\r\n        Vec3.add(this._targetPos,this._currPos,new Vec3(this._jumpStep,0,0));\r\n\r\n        this._isMoving = true;\r\n        this._currMoveIndex += step;\r\n    }\r\n\r\n    onOnceJumpEnd() {\r\n        this._isMoving = false;\r\n        this.node.emit('JumpEnd',this._currMoveIndex);\r\n    }\r\n\r\n    update (deltaTime: number) {\r\n        // [4]\r\n        if(this._startJump)\r\n        {\r\n            this._currJumpTime += deltaTime;\r\n            if(this._currJumpTime > this._jumpTime)\r\n            {\r\n                this.node.setPosition(this._targetPos);\r\n                this._startJump = false;\r\n                this.onOnceJumpEnd();\r\n            }\r\n            \r\n            else\r\n            {\r\n                this.node.getPosition(this._currPos);\r\n                this._deltaPos.x = this._currJumpSpeed * deltaTime;\r\n                Vec3.add(this._currPos,this._currPos,this._deltaPos);\r\n                this.node.setPosition(this._currPos);\r\n            }\r\n        }\r\n    }\r\n\r\n    setInputActive(active: boolean) {\r\n        if (active) {\r\n            systemEvent.on(SystemEvent.EventType.MOUSE_UP, this.onMouseUp, this);\r\n        } else {\r\n            systemEvent.off(SystemEvent.EventType.MOUSE_UP, this.onMouseUp, this);\r\n        }\r\n    }\r\n\r\n    reset() {\r\n        this._currMoveIndex = 0;\r\n    }\r\n}\r\n\r\n/**\r\n * [1] Class member could be defined like this.\r\n * [2] Use `property` decorator if your want the member to be serializable.\r\n * [3] Your initialization goes here.\r\n * [4] Your update function goes here.\r\n *\r\n * Learn more about scripting: https://docs.cocos.com/creator/3.3/manual/en/scripting/\r\n * Learn more about CCClass: https://docs.cocos.com/creator/3.3/manual/en/scripting/ccclass.html\r\n * Learn more about life-cycle callbacks: https://docs.cocos.com/creator/3.3/manual/en/scripting/life-cycle-callbacks.html\r\n */\r\n"]}